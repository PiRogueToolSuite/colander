{% load i18n %}


<div class="card m-1 shadow-sm bg-secondary-light border-secondary">
  <div class="card-body p-2">
    <div class="row">
      <div class="col-md-8 text-truncate border-end border-secondary">
        <div class="border-bottom border-secondary">
          {% include "icons/detection_rule_icon.html" with c="h4 text-primary" %}
          <a class="h4" href="{% url 'collect_detection_rule_details_view' case_id=detection_rule.case.id pk=detection_rule.id %}">
            {{ detection_rule.name }}
          </a>
          <div class="text-muted small">
            {{ detection_rule.type.name }}
          </div>
        </div>
        <div>
          <div class="text-tiny font-monospace text-muted mt-1">
            {% include "icons/id_icon.html" %}{{ detection_rule.id }}
          </div>
          <div class="text-tiny text-muted">
            {% include "icons/date_icon.html" %}
            {{ detection_rule.created_at }}
          </div>
          <div class="text-tiny text-muted">
            {% include "icons/case_icon.html" %}
            {{ detection_rule.case.name }}
          </div>
          <div class="text-tiny text-muted">
            {% include "icons/user_icon.html" %}
            {{ detection_rule.owner }} {% if detection_rule.owner == request.user %}(me){% endif %}
          </div>
        </div>
      </div>
      <div class="col-md-4 text-truncate ">
        <div class="row">
          <div class="col">
            {% include "tlp/show_tlp_pap.html" with element=detection_rule %}
            {% if detection_rule.attributes.tags %}
              {% include "helpers/tags.html" with entity=detection_rule %}
            {% endif %}
          </div>
          {% if detection_rule.thumbnail %}
            <div class="col-md-2">
              <img class="img-thumbnail mx-auto d-block" src="{{detection_rule.thumbnail_url}}" alt="{{detection_rule.name}}" style="max-height: 90px" />
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="card-footer bg-transparent border-secondary m-0 p-1 text-end">
    {% include "detection_rule/controls.html" with btn_class="btn-sm" exclude="" %}
  </div>
</div>
